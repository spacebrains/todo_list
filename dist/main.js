!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);class i{constructor(t=""){this.task=t,this.id=Math.random(),this.finished=!1}}class n extends i{constructor(t="",e=Date.now()){super(),this.task=t,this.finalTime=new Date(e),this.isFinish()}isFinish(){+new Date>this.finalTime&&(this.finished=!0)}}class o extends i{constructor(t=""){super(),this.task=t,this.subTasks=[]}addSubTask(t=""){const e=new i(t);return this.subTasks.push(e),e}remove(t){this.subTasks=this.subTasks.filter(e=>e.id!==+t)}deleteFinished(){this.subTasks=this.subTasks.filter(t=>!t.finished)}finishById(t){this.subTasks=this.subTasks.map(e=>(+e.id==+t&&(e.finished=!e.finished),e)),this.allFinished()}allFinished(){this.finished=this.subTasks.every(t=>t.finished)}search(t){return this.subTasks.filter(e=>e.task.toLowerCase().indexOf(t.toLowerCase())+1)}}class a{constructor(){this.todos=[],this.load()}addTask(t=""){const e=new i(t);return this.todos.push(e),e}addTaskWithSubTasks(t=""){const e=new o(t);return this.todos.push(e),e}addSubTask(t,e=""){let s;return this.todos.forEach(i=>{+i.id==+t&&i instanceof o&&(s=i.addSubTask(e))}),s||console.warn("not found task with id:"+t)}addTaskWithTimer(t="",e=+new Date+1e3){const s=new n(t,e);return this.todos.push(s),s}remove(t){this.todos=this.todos.filter(e=>(e instanceof o&&e.remove(t),e.id!==+t))}finishById(t){this.todos=this.todos.map(e=>(+e.id==+t?e.finished=!e.finished:e instanceof o&&e.finishById(t),e))}deleteFinished(){this.todos=this.todos.filter(t=>(t instanceof o&&t.deleteFinished(),!t.finished))}search(t){let e=[];return this.todos.forEach(s=>{s.task.toLowerCase().indexOf(t.toLowerCase())+1&&e.push(s),s instanceof o&&(e=[...e,...s.search(t)])}),e}save(){const t=this.todos.map(t=>{const e={task:t.task,finished:t.finished};return t instanceof n?(e.type="TaskWithTimer",e.finalTime=t.finalTime):t instanceof o?(e.type="TaskWithSubTasks",e.subTasks=t.subTasks.map(t=>({task:t.task,finished:t.finished}))):e.type="Task",e});localStorage.data="",localStorage.data=JSON.stringify({todos:t})}load(){if(!localStorage.data)return;const t=JSON.parse(localStorage.data).todos;this.todos=t.map(t=>{if("Task"===t.type){const e=this.addTask(t.task);return e.finished=t.finished,e}if("TaskWithSubTasks"===t.type){const e=this.addTaskWithSubTasks(t.task);return e.finished=t.finished,t.subTasks.forEach(t=>{e.addSubTask(t.task).finished=t.finished}),e}if("TaskWithTimer"===t.type){const e=this.addTaskWithTimer(t.task,t.finalTime);return e.finished=t.finished,e}})}}const d=new class{constructor(){this.TodoApp=new a,this.todos=this.TodoApp.todos,this.ul=document.getElementById("todos"),this.div=document.getElementById("addTasks"),this.radio=document.getElementById("radio"),this.render()}render(){this.search(),this.drawTodos(),this.drawForms(),this.deleteFinished()}search(){const t=document.getElementById("search"),e=document.querySelector("#search input"),s=document.querySelector("#search span");t.onsubmit=(t=>{t.preventDefault(),this.todos=this.TodoApp.todos,this.todos=this.TodoApp.search(e.value),this.drawTodos()}),s.onclick=(()=>{this.todos=this.TodoApp.todos,e.value="",this.drawTodos()})}drawTask(t){const e=document.createElement("li"),s=document.createElement("div"),i=document.createElement("span"),n=document.createElement("button");return t.finished?i.className="finished":i.className="notFinished",i.innerText=t.task,n.innerText="x",e.dataset.id=t.id,s.appendChild(i),s.appendChild(n),e.appendChild(s),n.onclick=(t=>{t.preventDefault();const e=t.target.parentNode.parentNode.dataset.id;this.TodoApp.remove(e),this.TodoApp.save(),this.todos=this.TodoApp.todos,this.drawTodos()}),i.onclick=(t=>{const e=t.target.parentNode.parentNode.dataset.id;this.TodoApp.finishById(e),this.TodoApp.save(),this.todos=this.TodoApp.todos,this.drawTodos()}),e}drawTaskWithSubtasks(t){const e=this.drawTask(t),s=document.createElement("ul");t.subTasks.forEach(t=>{const e=this.drawTask(t);s.appendChild(e)});const i=document.createElement("div"),n=document.createElement("button");return n.innerText="+",i.appendChild(n),n.onclick=(t=>{const e=t.target.parentNode.parentNode.dataset.id;i.innerHTML="",i.appendChild(this.drawFormForSubTask(e))}),e.appendChild(s),e.appendChild(i),e}drawFormForSubTask(t){const e=document.createElement("form"),s=document.createElement("input"),i=document.createElement("button");return i.innerText="add",e.appendChild(s),e.appendChild(i),e.onsubmit=(e=>{e.preventDefault(),this.TodoApp.addSubTask(t,s.value),this.TodoApp.save(),this.drawTodos()}),e}drawTaskWithTimer(t){const e=this.drawTask(t),s=document.createElement("span");return s.innerText=`${Math.round((t.finalTime-Date.now())/36e5)} hours`,e.appendChild(s),e}drawTodos(){this.ul.innerHTML="",this.todos.forEach(t=>{let e;t instanceof o?e=this.drawTaskWithSubtasks(t):t instanceof n?e=this.drawTaskWithTimer(t):t instanceof i&&(e=this.drawTask(t)),this.ul.appendChild(e)})}drawFormForTask(){const t=document.createElement("form"),e=document.createElement("input"),s=document.createElement("button");return s.innerText="add",t.appendChild(e),t.appendChild(s),t.onsubmit=(t=>{t.preventDefault(),this.TodoApp.addTask(e.value),this.TodoApp.save(),this.drawTodos()}),t}drawFormForTaskWithSubTasks(){const t=document.createElement("form"),e=document.createElement("input"),s=document.createElement("button");return s.innerText="add",t.appendChild(e),t.appendChild(s),t.onsubmit=(t=>{t.preventDefault(),this.TodoApp.addTaskWithSubTasks(e.value),this.TodoApp.save(),this.drawTodos()}),t}drawFormForTaskWithTimer(){const t=document.createElement("form"),e=document.createElement("input");e.type="text";const s=document.createElement("input");s.setAttribute("type","datetime-local");const i=document.createElement("button");return i.innerText="add",t.appendChild(e),t.appendChild(s),t.appendChild(i),t.onsubmit=(t=>{t.preventDefault(),this.TodoApp.addTaskWithTimer(e.value,s.value),this.TodoApp.save(),this.drawTodos()}),t}drawForms(){const t=document.createElement("button");t.innerText="x",t.onclick=(()=>{this.div.innerHTML=""}),this.radio.onchange=(e=>{this.div.innerHTML="";const s=e.target.parentNode.dataset.type;let i;"Task"===s?i=this.drawFormForTask():"TaskWithSubTasks"===s?i=this.drawFormForTaskWithSubTasks():"TaskWithTimer"===s&&(i=this.drawFormForTaskWithTimer()),this.div.appendChild(i),this.div.appendChild(t)})}deleteFinished(){document.getElementById("deleteFinished").onclick=(()=>{this.TodoApp.deleteFinished(),this.TodoApp.save(),this.todos=this.TodoApp.todos,this.drawTodos()})}};console.log(d)}]);